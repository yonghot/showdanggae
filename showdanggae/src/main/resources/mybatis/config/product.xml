<?xml version="1.0" encoding="UTF-8"?>
<!-- Sql Mapper -->
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="product">

	<!-- 강민석 영역 -->
	
	<select id="deleteProduct">
	 	<![CDATA[
	 		delete *
	 		from product
	 		where product_id=#{value}
	 	]]>
	</select>

	<select id="deleteProductList">
	 	<![CDATA[
	 		delete *
	 		from product
	 		where category_id=#{value}
	 	]]>
	</select>
	
	<!-- <insert id="write"> <![CDATA[ insert into board(no, title, author, 
		write_date, content, id) values(board_seq.nextval, #{title}, #{author}, sysdate, 
		#{content} ,#{id}) ]]> </insert> <update id="hit"> <![CDATA[ update board 
		set hit=hit+1 where no=#{value} ]]> </update> <select id="showContent" resultType="bvo"> 
		<![CDATA[ select no, title, author, to_char(write_date, 'yyyy.mm.dd HH24:MI:SS') 
		as write_date, hit, content, id from board where no=#{no} ]]> </select> <update 
		id="update"> <![CDATA[ update board set title=#{title}, content=#{content}, 
		write_date=sysdate where no=#{no} ]]> </update> <delete id="delete"> <![CDATA[ 
		delete from board where no=#{value} ]]> </delete> <select id="getTotalPostNum" 
		resultType="int"> <![CDATA[ select count(*) from board ]]> </select> -->
		
		
	<!-- 김용호 영역 -->
		
	<select id="getAllBoardList" resultType="pvo">
	 	<![CDATA[
	 		select product_id, category_id, member_id, likes, dislikes, review_score, product_name, to_char(regist_date, 'yyyy.mm.dd') as regist_date, hits 
	 		from (select rownum as product_id, category_id, member_id, likes, dislikes, review_score, product_name, regist_date, hits
	 		from (select category_id, member_id, likes, dislikes, review_score, product_name, regist_date, hits from product order by likes desc))
	 	]]>
		<!-- <where>
			 <if test="value=='likes'">
				<![CDATA[
					from (select category_id, member_id, likes, dislikes, review_score, product_name, regist_date, hits from product order by likes desc))
				]]>
			 </if> 
			 <if test="value=='maker'">
			 	<![CDATA[
			 		from (select category_id, member_id, likes, dislikes, review_score, product_name, regist_date, hits from product order by product_id asc))
	 				where member_id=#{member_id} and category_id=#{currentCategory}
				]]> 
			 </if>
		</where> -->
	</select>
	
	
	<select id="getMyProductList" resultType="pvo">
	 	<![CDATA[
	 		select product_id, category_id, member_id, likes, dislikes, review_score, product_name, to_char(regist_date, 'yyyy.mm.dd') as regist_date, hits 
	 		from (select rownum as product_id, category_id, member_id, likes, dislikes, review_score, product_name, regist_date, hits
	 		from (select category_id, member_id, likes, dislikes, review_score, product_name, regist_date, hits from product order by product_id asc))
	 		where member_id=#{member_id} and category_id=#{currentCategory}
	 	]]>
	</select>
	
	<select id="getItemList" resultType="java.lang.String">
	 	<![CDATA[
	 		select item from item
	 	]]>
	</select>
	
	<insert id="registProduct">
		<selectKey keyProperty="product_id" order="BEFORE" resultType="int">
			<![CDATA[
				select product_seq.nextval from dual
			]]>
		</selectKey>
		<![CDATA[
	 		insert into product(product_id, category_id, member_id, product_name, detail, visiblity, regist_date)
	 		values(#{product_id}, #{category_id}, #{member_id}, #{product_name}, #{detail}, #{visiblity}, sysdate)
	 	]]>
	</insert>
	
	<insert id="addSellerLink">
		<![CDATA[
	 		insert into seller_link(product_id, link, price)
	 		values(#{product_id}, #{link}, #{price})
	 	]]>
	</insert>
	
	<insert id="addEvaluatingItem">
		<![CDATA[
	 		insert into eval_item(product_id, item, item_point)
	 		values(#{product_id}, #{item}, #{item_point})
	 	]]>
	</insert>
	
	<update id="hit">
		<![CDATA[
			update product set hits = hits + 1
			where product_id=#{value}
	 	]]>
	</update>
	
	<select id="getProductByProduct_id" resultType="pvo">
		<![CDATA[
			select product_id, category_id, member_id, likes, dislikes, review_score, product_name, to_char(regist_date, 'yyyy.mm.dd') as regist_date, hits 
	 		from product
			where product_id=#{value}
	 	]]>
	</select>
	
	<select id="getSellerLinkByProduct_id" resultType="slvo">
		<![CDATA[
			select link, price 
	 		from seller_link
			where product_id=#{value}
	 	]]>
	</select>
	
	<select id="getEvaluatingItemByProduct_id" resultType="evo">
		<![CDATA[
			select item, itme_point
	 		from eval_item
			where product_id=#{value}
	 	]]>
	</select>
		
</mapper>
 
 

 <!-- dynamin SQL -->
	<!-- <select id="findByNameOrMaker" resultType="mpvo">
	 		select * from myproduct
		<where>
			 <if test="nameOrMaker=='name'">
				<![CDATA[
 					name like '%' || #{input} || '%'
 				]]>
			 </if> 
			 <if test="nameOrMaker=='maker'">
			 	<![CDATA[
			 		maker like '%' || #{input} || '%'
 				]]> 
			 </if>
		</where>
	</select> -->
 
 
 
 
 
